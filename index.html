<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Threat Hunter - Cyber Defense Game</title>
  <style>
    body {
      margin: 0;
      background: radial-gradient(circle at top, #1b3358 0%, #050810 55%, #020308 100%);
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      font-family: Arial, sans-serif;
      color: #fff;
    }

    #gameContainer {
      position: relative;
      width: 800px;
      height: 500px;
      border-radius: 10px;
      border: 2px solid #00e5ff;
      box-shadow: 0 0 25px rgba(0, 229, 255, 0.4);
      background: radial-gradient(circle at center, #151521 0%, #050509 70%);
      overflow: hidden;
    }

    #gameCanvas {
      display: block;
      background: repeating-linear-gradient(
        to bottom,
        #050509,
        #050509 10px,
        #090914 10px,
        #090914 20px
      );
    }

    /* HUD */
    #hud {
      position: absolute;
      top: 8px;
      left: 8px;
      font-size: 14px;
      text-shadow: 0 0 4px #000;
      line-height: 1.4;
    }

    #hud span.label {
      color: #9bd1ff;
      font-weight: bold;
    }

    /* Legend */
    #legend {
      position: absolute;
      top: 8px;
      right: 8px;
      background: rgba(2, 6, 18, 0.85);
      border-radius: 6px;
      padding: 6px 10px;
      font-size: 11px;
      border: 1px solid #1f4068;
      box-shadow: 0 0 10px rgba(0,0,0,0.6);
    }

    #legend-title {
      font-weight: bold;
      margin-bottom: 4px;
      color: #9bd1ff;
      text-align: center;
    }

    .legend-row {
      display: flex;
      align-items: center;
      gap: 6px;
      margin: 2px 0;
    }

    .legend-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
    }
    .legend-threat { background: #ff4b4b; }
    .legend-safe   { background: #3ad16b; }

    #message {
      position: absolute;
      bottom: 8px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 15px;
      text-shadow: 0 0 6px #000;
      text-align: center;
      max-width: 90%;
    }

    #crosshair {
      position: absolute;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      border: 2px solid #ff0000;
      pointer-events: none;
      box-shadow: 0 0 8px #f00;
    }

    #centerDot {
      position: absolute;
      width: 4px;
      height: 4px;
      background: #ff0000;
      border-radius: 50%;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      box-shadow: 0 0 4px #f00;
    }

    #startOverlay {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.85);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      padding: 20px;
    }

    #startOverlay h1 {
      margin-bottom: 10px;
      color: #ff4b4b;
      text-shadow: 0 0 8px #f00;
      font-size: 28px;
    }

    #startOverlay p {
      max-width: 420px;
    }

    #startOverlay button {
      margin-top: 15px;
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      border-radius: 6px;
      background: #ff3333;
      color: #fff;
      cursor: pointer;
      box-shadow: 0 0 8px #f00;
    }

    #startOverlay button:hover {
      background: #ff5555;
    }
  </style>
</head>
<body>
  <div id="gameContainer">
    <canvas id="gameCanvas" width="800" height="500"></canvas>

    <div id="hud">
      <div><span class="label">Score:</span> <span id="score">0</span></div>
      <div><span class="label">Health:</span> <span id="health">3</span></div>
      <div><span class="label">Items on screen:</span> <span id="threats">0</span></div>
    </div>

    <div id="legend">
      <div id="legend-title">Threat Hunter</div>
      <div class="legend-row">
        <span class="legend-dot legend-threat"></span> Shoot these (threats)
      </div>
      <div class="legend-row">
        <span class="legend-dot legend-safe"></span> Donâ€™t shoot (safe)
      </div>
    </div>

    <div id="message"></div>
    <div id="crosshair"></div>
    <div id="centerDot"></div>

    <div id="startOverlay">
      <h1>Threat Hunter</h1>
      <p>
        You are a Security Analyst.  
        Shoot <strong>only the cyber threats</strong> (malware, unsafe downloads,
        fake pop-ups, sketchy Wi-Fi) and <strong>avoid hitting safe items</strong>.
      </p>
      <p style="font-size: 13px; margin-top: 6px;">
        +10 points for stopping a threat.  
        Losing health for letting a threat through or shooting something safe.
      </p>
      <button onclick="startGame()">Start Game</button>
    </div>
  </div>

  <script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    const scoreEl = document.getElementById('score');
    const healthEl = document.getElementById('health');
    const threatsEl = document.getElementById('threats');
    const messageEl = document.getElementById('message');
    const crosshairEl = document.getElementById('crosshair');
    const startOverlay = document.getElementById('startOverlay');
    const container = document.getElementById('gameContainer');

    // GAME STATE
    let entities = [];   // falling items
    let score = 0;
    let health = 3;
    let isGameOver = false;
    let lastSpawnTime = 0;
    let spawnInterval = 1500;
    let lastTime = 0;

    // ðŸ”´ / ðŸŸ¢ SCENARIOS
    // NOTE: put your images in /assets and name them to match imgSrc
    const CARDS = [
  {
    id: 'file_explorer',
    label: 'Suspicious files in downloads',
    imgSrc: 'assets/File Explorer.jpg',
    isThreat: true
  },
  {
    id: 'permission_app',
    label: 'App asks for odd permissions',
    imgSrc: 'assets/Permission app.jpg',
    isThreat: true
  },
  {
    id: 'remote_access',
    label: 'Remote access request',
    imgSrc: 'assets/Remote Access.jpg',
    isThreat: true
  },
  {
    id: 'warning_ssl',
    label: 'Connection not private',
    imgSrc: 'assets/warning.jpg',
    isThreat: true
  },
  {
    id: 'wifi_public',
    label: 'Free public Wi-Fi',
    imgSrc: 'assets/wifi.jpg',
    isThreat: true
  },
  {
    id: 'gnome_weird',
    label: 'Unknown / suspicious link',
    imgSrc: 'assets/profile.jpg',
    isThreat: true
  }
];


    // Preload images
    CARDS.forEach(card => {
      const img = new Image();
      img.src = card.imgSrc;
      card.img = img;
    });

    function resetGame() {
      entities = [];
      score = 0;
      health = 3;
      isGameOver = false;
      spawnInterval = 1500;
      lastSpawnTime = 0;
      lastTime = 0;
      messageEl.textContent = '';
      updateHUD();
    }

    function startGame() {
      startOverlay.style.display = 'none';
      resetGame();
      requestAnimationFrame(gameLoop);
    }

    function spawnEntity() {
      const card = CARDS[Math.floor(Math.random() * CARDS.length)];
      const width = 150;
      const height = 110;
      const x = Math.random() * (canvas.width - width - 80) + 40 + width / 2;
      const speed = 0.5 + Math.random() * 0.45;

      entities.push({
        x,
        y: -height,
        w: width,
        h: height,
        speed,
        card
      });

      threatsEl.textContent = entities.length;
    }

    function update(delta) {
      if (isGameOver) return;

      // spawn new item
      if (lastTime - lastSpawnTime > spawnInterval) {
        spawnEntity();
        lastSpawnTime = lastTime;
        if (spawnInterval > 750) {
          spawnInterval -= 12; // ramp difficulty
        }
      }

      // move items
      for (let i = entities.length - 1; i >= 0; i--) {
        const e = entities[i];
        e.y += e.speed * (delta / 16);

        if (e.y > canvas.height - 40) { // reached bottom
          if (e.card.isThreat) {
            health--;
            showFact('Threat missed: ' + e.card.onMiss, '#ff6666');
            if (health <= 0) {
              health = 0;
              entities.splice(i, 1);
              updateHUD();
              gameOver();
              return;
            }
          }
          // safe item at bottom = no penalty
          entities.splice(i, 1);
        }
      }

      updateHUD();
    }

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // side walls
      ctx.fillStyle = '#111423';
      ctx.fillRect(0, 0, 40, canvas.height);
      ctx.fillRect(canvas.width - 40, 0, 40, canvas.height);

      // floor
      const grd = ctx.createLinearGradient(0, canvas.height * 0.6, 0, canvas.height);
      grd.addColorStop(0, '#151522');
      grd.addColorStop(1, '#050509');
      ctx.fillStyle = grd;
      ctx.fillRect(0, canvas.height * 0.6, canvas.width, canvas.height * 0.4);

      // items
      entities.forEach(e => {
        const { card } = e;
        const x = e.x - e.w / 2;
        const y = e.y - e.h / 2;

        // background card
        ctx.fillStyle = 'rgba(5, 10, 25, 0.9)';
        ctx.fillRect(x, y, e.w, e.h);

        // image
        if (card.img && card.img.complete) {
          ctx.drawImage(card.img, x + 5, y + 5, e.w - 10, e.h - 30);
        }

        // border (same color for all so it doesnâ€™t give away threat vs safe)
        ctx.strokeStyle = '#00e5ff';
        ctx.lineWidth = 1;
        ctx.strokeRect(x, y, e.w, e.h);

        // label
        ctx.fillStyle = '#ffffff';
        ctx.font = '11px Arial';
        ctx.textAlign = 'center';
        ctx.fillText(card.label, e.x, y + e.h - 8);
      });

      // bottom HUD bar
      ctx.fillStyle = '#2b0710';
      ctx.fillRect(0, canvas.height - 40, canvas.width, 40);
      ctx.fillStyle = '#ff4b4b';
      ctx.font = 'bold 18px Arial';
      ctx.textAlign = 'left';
      ctx.fillText('THREAT HUNTER', 10, canvas.height - 14);
    }

    function gameLoop(timestamp) {
      if (!lastTime) lastTime = timestamp;
      const delta = timestamp - lastTime;
      lastTime = timestamp;

      update(delta);
      draw();

      if (!isGameOver) {
        requestAnimationFrame(gameLoop);
      }
    }

    function updateHUD() {
      scoreEl.textContent = score;
      healthEl.textContent = health;
      threatsEl.textContent = entities.length;
    }

    function showFact(text, color = '#66ff66') {
      messageEl.style.color = color;
      messageEl.textContent = text;
      clearTimeout(messageEl._timeout);
      messageEl._timeout = setTimeout(() => {
        messageEl.textContent = '';
      }, 2700);
    }

    function gameOver() {
      isGameOver = true;
      showFact('GAME OVER â€“ Your analysis failed. ðŸ’€', '#ff4444');
      setTimeout(() => {
        startOverlay.style.display = 'flex';
        startOverlay.querySelector('p').innerHTML =
          'Final Score: ' + score +
          '<br>Refresh or click <strong>Start Game</strong> to hunt threats again.';
      }, 1200);
    }

    function getMousePos(evt) {
      const r = canvas.getBoundingClientRect();
      return {
        x: evt.clientX - r.left,
        y: evt.clientY - r.top
      };
    }

    // click to shoot
    canvas.addEventListener('click', (evt) => {
      if (isGameOver) return;
      const pos = getMousePos(evt);

      for (let i = entities.length - 1; i >= 0; i--) {
        const e = entities[i];
        const left = e.x - e.w / 2;
        const right = e.x + e.w / 2;
        const top = e.y - e.h / 2;
        const bottom = e.y + e.h / 2;

        if (pos.x >= left && pos.x <= right && pos.y >= top && pos.y <= bottom) {
          // hit
          if (e.card.isThreat) {
            score += 10;
            showFact(e.card.onShoot, '#66ff66');
          } else {
            health--;
            showFact(e.card.onShoot, '#ff9999');
            if (health <= 0) {
              health = 0;
              entities.splice(i, 1);
              updateHUD();
              gameOver();
              return;
            }
          }
          entities.splice(i, 1);
          updateHUD();
          return;
        }
      }
    });

    // move crosshair with mouse
    container.addEventListener('mousemove', (evt) => {
      const r = container.getBoundingClientRect();
      const x = evt.clientX - r.left;
      const y = evt.clientY - r.top;

      crosshairEl.style.left = (x - 10) + 'px';
      crosshairEl.style.top = (y - 10) + 'px';
    });
  </script>
</body>
</html>
